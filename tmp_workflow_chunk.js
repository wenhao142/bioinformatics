(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3890:function(a,e,t){Promise.resolve().then(t.bind(t,8536))},8536:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return c}});var s=t(3827),o=t(9102),n=t.n(o),r=t(4090),i=t(7907);let l=[{plugin_id:"fasta_qc",name:"FASTA QC",version:"0.1.0",tags:["wgs","qc","reference"],source:"builtin",default_input_types:{},default_output_types:{report:"report.html"},default_parameters:{mode:"fasta-basic-qc"}},{plugin_id:"fastqc",name:"FastQC",version:"0.1.0",tags:["rna-seq","wgs","qc"],source:"builtin",default_input_types:{reads:"reads.fastq.gz"},default_output_types:{report:"report.html"},default_parameters:{threads:2}},{plugin_id:"cutadapt",name:"Cutadapt",version:"0.1.0",tags:["rna-seq","wgs","trim"],source:"builtin",default_input_types:{reads:"reads.fastq.gz"},default_output_types:{trimmed_reads:"reads.fastq.gz"},default_parameters:{quality_cutoff:20,min_length:20}},{plugin_id:"star_align",name:"STAR Align",version:"0.1.0",tags:["rna-seq","align"],source:"builtin",default_input_types:{reads:"reads.fastq.gz"},default_output_types:{alignment:"align.bam"},default_parameters:{threads:8}},{plugin_id:"samtools_sort_index",name:"samtools sort+index",version:"0.1.0",tags:["rna-seq","wgs","align"],source:"builtin",default_input_types:{alignment:"align.bam"},default_output_types:{alignment_sorted:"align.bam"},default_parameters:{threads:4}},{plugin_id:"featurecounts",name:"featureCounts",version:"0.1.0",tags:["rna-seq","counts"],source:"builtin",default_input_types:{alignment_sorted:"align.bam"},default_output_types:{counts:"expression.counts.tsv"},default_parameters:{threads:4,feature_type:"exon",attribute:"gene_id"}},{plugin_id:"deseq2_diffexp",name:"DESeq2",version:"0.1.0",tags:["rna-seq","diffexp"],source:"builtin",default_input_types:{counts:"expression.counts.tsv"},default_output_types:{diff_table:"expression.diff_table.tsv",report:"report.html"},default_parameters:{design_formula:"~ condition",alpha:.05}},{plugin_id:"bcftools_call",name:"bcftools call",version:"0.1.0",tags:["wgs","variant"],source:"builtin",default_input_types:{alignment_sorted:"align.bam"},default_output_types:{variants:"variants.vcf.gz"},default_parameters:{ploidy:2}},{plugin_id:"variant_report",name:"Variant Report",version:"0.1.0",tags:["wgs","report"],source:"builtin",default_input_types:{variants:"variants.vcf.gz"},default_output_types:{report:"report.html"},default_parameters:{}}];function d(a){let e=JSON.parse(a);if(!e||"object"!=typeof e||Array.isArray(e))throw Error("Must be a JSON object.");return e}function c(){var a,e;let t=(0,i.useRouter)(),o="http://localhost:18000",[c,p]=(0,r.useState)(null),[u,x]=(0,r.useState)(!1),[m,f]=(0,r.useState)([]),[g,h]=(0,r.useState)("demo-project"),[j,b]=(0,r.useState)("lego-flow"),[_,w]=(0,r.useState)([]),[v,y]=(0,r.useState)([]),[k,N]=(0,r.useState)('{"n2.alpha":[0.1,0.2]}'),[S,z]=(0,r.useState)(""),[C,O]=(0,r.useState)(""),[D,R]=(0,r.useState)(null),[J,P]=(0,r.useState)(null),[I,q]=(0,r.useState)({from_node:"",from_output:"",to_node:"",to_input:""}),[L,A]=(0,r.useState)([]),[E,T]=(0,r.useState)(""),M=(0,r.useMemo)(()=>{let a=g.trim(),e=j.trim();return a&&e?"".concat(a,"__").concat(e):""},[g,j]),W=(0,r.useMemo)(()=>M?"workflow-builder:draft:".concat(M):"",[M]),B=(0,r.useMemo)(()=>{let a=new Map(l.map(a=>[a.plugin_id,a])),e=m.filter(a=>!1!==a.enabled).map(e=>{let t=a.get(e.plugin_id);return{...e,source:"registry",default_input_types:(null==t?void 0:t.default_input_types)||{},default_output_types:(null==t?void 0:t.default_output_types)||{out:"report.html"},default_parameters:(null==t?void 0:t.default_parameters)||{}}}),t=[...e],s=new Set(e.map(a=>a.plugin_id));for(let a of l)s.has(a.plugin_id)||t.push(a);return t},[m]),U=(0,r.useMemo)(()=>{let a={},e={},t=[];for(let s of _){s.node_id.trim()||t.push("Node ID cannot be empty."),s.plugin_id.trim()||t.push("Node ".concat(s.node_id||"<empty>"," missing plugin_id."));try{let e=d(s.output_types);for(let[o,n]of(a[s.node_id]={},Object.entries(e)))"string"==typeof n&&n.trim()?a[s.node_id][o]=n.trim():t.push("Node ".concat(s.node_id," output_types.").concat(o," must be non-empty string canonical type."))}catch(a){t.push("Node ".concat(s.node_id||"<empty>"," output_types JSON invalid: ").concat(a.message))}try{let a=d(s.input_types);for(let[o,n]of(e[s.node_id]={},Object.entries(a)))"string"==typeof n&&n.trim()?e[s.node_id][o]=n.trim():t.push("Node ".concat(s.node_id," input_types.").concat(o," must be non-empty string canonical type."))}catch(a){t.push("Node ".concat(s.node_id||"<empty>"," input_types JSON invalid: ").concat(a.message))}try{d(s.parameters)}catch(a){t.push("Node ".concat(s.node_id||"<empty>"," parameters JSON invalid: ").concat(a.message))}}return{outputs:a,inputs:e,errors:t}},[_]),F=(0,r.useMemo)(()=>{let a={};for(let e of _)a[e.node_id]={outputs:Object.keys(U.outputs[e.node_id]||{}),inputs:Object.keys(U.inputs[e.node_id]||{})};return a},[_,U]),V=(0,r.useMemo)(()=>{let a=[];g.trim()||a.push("Project ID is required."),j.trim()||a.push("Workflow name is required."),M||a.push("Workflow ID cannot be empty."),0===_.length&&a.push("Workflow must contain at least one node.");let e=_.map(a=>a.node_id),t=new Set;for(let s of e)s.trim()&&(t.has(s)&&a.push("Duplicate node_id: ".concat(s)),t.add(s));a.push(...U.errors);let s=new Set;for(let e of v){var o,n;let t="".concat(e.from_node,".").concat(e.from_output,"->").concat(e.to_node,".").concat(e.to_input);s.has(t)&&a.push("Duplicate edge: ".concat(t)),s.add(t),e.from_node===e.to_node&&a.push("Self-loop is not allowed: ".concat(t));let r=null===(o=U.outputs[e.from_node])||void 0===o?void 0:o[e.from_output],i=null===(n=U.inputs[e.to_node])||void 0===n?void 0:n[e.to_input];r||a.push("Edge invalid source port: ".concat(e.from_node,".").concat(e.from_output)),i||a.push("Edge invalid target port: ".concat(e.to_node,".").concat(e.to_input)),r&&i&&r!==i&&a.push("Type mismatch: ".concat(e.from_node,".").concat(e.from_output," (").concat(r,") -> ").concat(e.to_node,".").concat(e.to_input," (").concat(i,")"))}try{let e=d(k);for(let[s,o]of Object.entries(e)){if(!s.includes(".")){a.push("Sweep key must be node.param: ".concat(s));continue}let[e,n]=s.split(".",2);t.has(e)||a.push("Sweep references unknown node: ".concat(e)),n||a.push("Sweep key missing param name: ".concat(s)),Array.isArray(o)&&0!==o.length||a.push("Sweep value must be non-empty array: ".concat(s))}}catch(e){a.push("Parameter sweeps JSON invalid: ".concat(e.message))}return a},[g,j,M,_,v,k,U]),G=c?{Authorization:"Bearer ".concat(c),"Content-Type":"application/json"}:null;async function Q(){var a;if(!G){O("Please sign in first.");return}O("");let e=await fetch("".concat(o,"/plugins"),{headers:G});if(!e.ok){O("Load plugins failed: ".concat(e.status));return}let t=await e.json();f(t.plugins||[]),z("Loaded ".concat((null===(a=t.plugins)||void 0===a?void 0:a.length)||0," plugins."))}function H(a){O("");let e=_.length+1,t="n".concat(e);w(e=>[...e,{node_id:t,plugin_id:a.plugin_id,version:a.version,input_types:JSON.stringify(a.default_input_types||{},null,2),output_types:JSON.stringify(a.default_output_types||{out:"report.html"},null,2),parameters:JSON.stringify(a.default_parameters||{},null,2)}]),z("Added node ".concat(t," (").concat(a.plugin_id,")"))}function K(a,e,t){w(s=>s.map(s=>s.node_id===a?{...s,[e]:t}:s))}async function X(){let a;if(!G){O("Please sign in first.");return}O("");try{a=function(){if(V.length>0)throw Error("Please fix ".concat(V.length," validation issue(s) before save/run."));let a=_.map(a=>({node_id:a.node_id,plugin_id:a.plugin_id,version:a.version||void 0,input_types:d(a.input_types),output_types:d(a.output_types),parameters:d(a.parameters)}));return{workflow_id:M,nodes:a,edges:v,parameter_sweeps:d(k)}}()}catch(a){O(a.message);return}let e=await fetch("".concat(o,"/workflows/import"),{method:"POST",headers:G,body:JSON.stringify(a)});if(409===e.status){let a=await fetch("".concat(o,"/workflows/").concat(M,"/validate"),{method:"POST",headers:G});if(!a.ok){let e=await a.text();O("Validate failed: ".concat(a.status," ").concat(e));return}z("Workflow already existed; validation refreshed and reusable.");return}if(!e.ok){let a=await e.text();O("Import failed: ".concat(e.status," ").concat(a));return}z("Workflow imported and validated.")}async function Y(){if(!G){O("Please sign in first.");return}if(O(""),V.length>0){O("Cannot run with validation issues (".concat(V.length,")."));return}let a=await fetch("".concat(o,"/workflows/").concat(M,"/execute/distributed"),{method:"POST",headers:G,body:JSON.stringify({max_workers:2})});if(!a.ok){let e=await a.text();O("Run failed: ".concat(a.status," ").concat(e));return}let e=await a.json();R(e.summary),P(e),z("Distributed run completed: ".concat(e.summary.run_id))}async function Z(){if(!G||!(null==D?void 0:D.run_id))return;O("");let a=await fetch("".concat(o,"/workflows/runs/").concat(D.run_id),{headers:G});if(!a.ok){O("Refresh run failed: ".concat(a.status));return}P(await a.json()),z("Run details refreshed.")}async function $(){var a,e;if(!G){O("Please sign in first.");return}O("");let t=await fetch("".concat(o,"/workflows/").concat(M,"/export"),{headers:G});if(!t.ok){O("Export failed: ".concat(t.status));return}let s=await t.json(),n=["# Workflow Reproducibility Report","","- workflow_id: ".concat(M),"- generated_at: ".concat(new Date().toISOString()),"- node_count: ".concat((null===(a=s.workflow.nodes)||void 0===a?void 0:a.length)||0),"- edge_count: ".concat((null===(e=s.workflow.edges)||void 0===e?void 0:e.length)||0),D?"- last_run_id: ".concat(D.run_id):"- last_run_id: n/a","","## Workflow JSON","```json",JSON.stringify(s.workflow,null,2),"```","","## Last Run","```json",JSON.stringify(J||{},null,2),"```"];!function(a,e){let t=new Blob([e],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(t),o=document.createElement("a");o.href=s,o.download=a,o.click(),URL.revokeObjectURL(s)}("".concat(M,".reproducibility.md"),n.join("\n")),z("Reproducibility report exported.")}async function aa(){if(!G){O("Please sign in first.");return}O("");let a=await fetch("".concat(o,"/workflows"),{headers:G});if(!a.ok){O("Load workflows failed: ".concat(a.status));return}let e=await a.json(),t="".concat(g.trim(),"__"),s=(e.workflows||[]).filter(a=>a.workflow_id.startsWith(t));A(s),s.length>0?T(s[0].workflow_id):T(""),z("Loaded ".concat(s.length," saved workflow(s) for project ").concat(g,"."))}async function ae(){if(!G){O("Please sign in first.");return}if(!E){O("Please select a saved workflow.");return}O("");let a=await fetch("".concat(o,"/workflows/").concat(encodeURIComponent(E),"/export"),{headers:G});if(!a.ok){let e=await a.text();O("Load workflow failed: ".concat(a.status," ").concat(e));return}let e=(await a.json()).workflow||{},t=Array.isArray(e.nodes)?e.nodes:[],s=Array.isArray(e.edges)?e.edges:[],n=e.parameter_sweeps||{};b(String(E).split("__").slice(1).join("__")||j),w(t.map(a=>({node_id:String(a.node_id||""),plugin_id:String(a.plugin_id||""),version:String(a.version||""),input_types:JSON.stringify(a.input_types||{},null,2),output_types:JSON.stringify(a.output_types||{},null,2),parameters:JSON.stringify(a.parameters||{},null,2)}))),y(s.map(a=>({from_node:String(a.from_node||""),from_output:String(a.from_output||""),to_node:String(a.to_node||""),to_input:String(a.to_input||"")}))),N(JSON.stringify(n,null,2)),z("Loaded workflow ".concat(E,"."))}return(0,r.useEffect)(()=>{let a=window.localStorage.getItem("ad_api_token");if(a){p(a),x(!0);return}x(!0),t.replace("/login")},[t]),(0,r.useEffect)(()=>{if(u){if(!c){window.localStorage.removeItem("ad_api_token");return}window.localStorage.setItem("ad_api_token",c)}},[c,u]),u&&c?(0,s.jsxs)("main",{className:"jsx-8751881a20a6730a analysis-page workflow-page",children:[(0,s.jsx)("div",{className:"jsx-8751881a20a6730a ambient-shape shape-a"}),(0,s.jsx)("div",{className:"jsx-8751881a20a6730a ambient-shape shape-b"}),(0,s.jsxs)("header",{className:"jsx-8751881a20a6730a hero-panel reveal reveal-1",children:[(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a",children:[(0,s.jsx)("p",{className:"jsx-8751881a20a6730a hero-kicker",children:"AD Multi-Omics Locus Evidence Platform"}),(0,s.jsx)("h1",{className:"jsx-8751881a20a6730a hero-title",children:"Workflow Builder"}),(0,s.jsx)("p",{className:"jsx-8751881a20a6730a hero-note",children:"Compose methods like Lego blocks, validate wiring before execution, and export reproducibility artifacts."})]}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a health-pill health-pill-ok",children:["Signed in \xb7 ",M||"unscoped"]})]}),(0,s.jsxs)("section",{className:"jsx-8751881a20a6730a surface-section split-shell",children:[(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a mini-card",children:[(0,s.jsx)("h2",{className:"jsx-8751881a20a6730a",children:"Session"}),(0,s.jsx)("p",{style:{margin:0},className:"jsx-8751881a20a6730a ok-text",children:"Authenticated session is active."}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a btn-row",children:[(0,s.jsx)("button",{onClick:function(){p(null),t.replace("/login")},className:"jsx-8751881a20a6730a",children:"Logout"}),(0,s.jsx)("button",{onClick:()=>t.push("/login"),className:"jsx-8751881a20a6730a",children:"Switch Account"}),(0,s.jsx)("button",{onClick:()=>void Q(),className:"jsx-8751881a20a6730a",children:"Load Tools"}),(0,s.jsx)("button",{onClick:()=>void aa(),className:"jsx-8751881a20a6730a",children:"Load Saved Workflows"})]})]}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a mini-card",children:[(0,s.jsx)("h2",{className:"jsx-8751881a20a6730a",children:"Workflow"}),(0,s.jsxs)("label",{className:"jsx-8751881a20a6730a",children:["Project ID",(0,s.jsx)("input",{value:g,onChange:a=>h(a.target.value),className:"jsx-8751881a20a6730a"})]}),(0,s.jsxs)("label",{className:"jsx-8751881a20a6730a",children:["Workflow Name",(0,s.jsx)("input",{value:j,onChange:a=>b(a.target.value),className:"jsx-8751881a20a6730a"})]}),(0,s.jsxs)("label",{className:"jsx-8751881a20a6730a",children:["Workflow ID (scoped)",(0,s.jsx)("input",{value:M,readOnly:!0,className:"jsx-8751881a20a6730a readonly"})]}),(0,s.jsxs)("label",{className:"jsx-8751881a20a6730a",children:["Parameter Sweeps (JSON)",(0,s.jsx)("textarea",{value:k,onChange:a=>N(a.target.value),rows:4,className:"jsx-8751881a20a6730a"})]}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a btn-row",children:[(0,s.jsx)("button",{onClick:()=>void X(),className:"jsx-8751881a20a6730a",children:"Validate & Save"}),(0,s.jsx)("button",{onClick:()=>void Y(),className:"jsx-8751881a20a6730a",children:"Run Distributed"}),(0,s.jsx)("button",{onClick:()=>void $(),className:"jsx-8751881a20a6730a",children:"Export Repro Report"})]}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a btn-row",children:[(0,s.jsx)("button",{onClick:function(){if(!W){O("Project ID and workflow name are required.");return}let a={projectId:g,workflowName:j,nodes:_,edges:v,sweepsRaw:k,savedAt:new Date().toISOString()};localStorage.setItem(W,JSON.stringify(a)),O(""),z("Draft saved locally (".concat(M,")."))},className:"jsx-8751881a20a6730a",children:"Save Local Draft"}),(0,s.jsx)("button",{onClick:function(){if(!W){O("Project ID and workflow name are required.");return}let a=localStorage.getItem(W);if(!a){O("No local draft found for this project/workflow.");return}try{let e=JSON.parse(a);w(e.nodes||[]),y(e.edges||[]),N(e.sweepsRaw||"{}"),O(""),z("Draft loaded (".concat(M,")."))}catch(a){O("Draft parse failed: ".concat(a.message))}},className:"jsx-8751881a20a6730a",children:"Load Local Draft"}),(0,s.jsx)("button",{onClick:function(){w([]),y([]),N("{}"),R(null),P(null),O(""),z("Canvas cleared.")},className:"jsx-8751881a20a6730a",children:"Clear Canvas"})]}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a btn-row",children:[(0,s.jsxs)("select",{value:E,onChange:a=>T(a.target.value),className:"jsx-8751881a20a6730a wide-select",children:[(0,s.jsx)("option",{value:"",className:"jsx-8751881a20a6730a",children:"Saved workflows in this project"}),L.map(a=>(0,s.jsxs)("option",{value:a.workflow_id,className:"jsx-8751881a20a6730a",children:[a.workflow_id," (",a.node_count," nodes, ",a.edge_count," edges)"]},a.workflow_id))]}),(0,s.jsx)("button",{onClick:()=>void ae(),className:"jsx-8751881a20a6730a",children:"Load Selected"})]})]})]}),(0,s.jsxs)("section",{className:"jsx-8751881a20a6730a surface-section",children:[(0,s.jsx)("h2",{className:"jsx-8751881a20a6730a",children:"Validation"}),0===V.length?(0,s.jsx)("p",{className:"jsx-8751881a20a6730a ok-text",children:"No validation errors. Workflow is ready to save and run."}):(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a",children:[(0,s.jsxs)("p",{className:"jsx-8751881a20a6730a err-text",children:["Found ",V.length," issue(s):"]}),(0,s.jsx)("ul",{className:"jsx-8751881a20a6730a",children:V.map((a,e)=>(0,s.jsx)("li",{className:"jsx-8751881a20a6730a",children:a},"issue-".concat(e)))})]})]}),(0,s.jsxs)("section",{className:"jsx-8751881a20a6730a surface-section tool-shell",children:[(0,s.jsxs)("aside",{className:"jsx-8751881a20a6730a mini-card",children:[(0,s.jsx)("h2",{className:"jsx-8751881a20a6730a",children:"Tool Palette"}),(0,s.jsx)("p",{style:{margin:0,color:"#4d626e",fontSize:12},className:"jsx-8751881a20a6730a",children:"Built-in RNA-seq/WGS tools are always available. Registry tools are merged after clicking Load Tools."}),B.map(a=>(0,s.jsxs)("div",{draggable:!0,onDragStart:e=>e.dataTransfer.setData("text/plain",a.plugin_id),onDoubleClick:()=>H(a),className:"jsx-8751881a20a6730a palette-item",children:[(0,s.jsx)("strong",{className:"jsx-8751881a20a6730a",children:a.plugin_id}),(0,s.jsx)("div",{className:"jsx-8751881a20a6730a",children:a.name}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a",children:["v",a.version]}),(0,s.jsx)("div",{className:"jsx-8751881a20a6730a",children:(a.tags||[]).join(", ")||"no-tags"}),(0,s.jsx)("div",{className:"jsx-8751881a20a6730a",children:"registry"===a.source?"source: API registry":"source: built-in template"})]},"".concat(a.plugin_id,":").concat(a.version)))]}),(0,s.jsxs)("div",{onDragOver:a=>a.preventDefault(),onDrop:function(a){a.preventDefault();let e=a.dataTransfer.getData("text/plain"),t=B.find(a=>a.plugin_id===e);t&&H(t)},className:"jsx-8751881a20a6730a canvas-box",children:[(0,s.jsx)("h2",{className:"jsx-8751881a20a6730a",children:"Canvas"}),0===_.length?(0,s.jsx)("p",{className:"jsx-8751881a20a6730a",children:"No nodes yet. Drag a tool from the left panel."}):null,_.map(a=>(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a node-card",children:[(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a node-top",children:[(0,s.jsx)("input",{value:a.node_id,onChange:e=>K(a.node_id,"node_id",e.target.value),className:"jsx-8751881a20a6730a"}),(0,s.jsx)("input",{value:a.plugin_id,onChange:e=>K(a.node_id,"plugin_id",e.target.value),className:"jsx-8751881a20a6730a"}),(0,s.jsx)("input",{value:a.version,onChange:e=>K(a.node_id,"version",e.target.value),className:"jsx-8751881a20a6730a"})]}),(0,s.jsxs)("label",{className:"jsx-8751881a20a6730a",children:["Input types (JSON)",(0,s.jsx)("textarea",{value:a.input_types,onChange:e=>K(a.node_id,"input_types",e.target.value),rows:2,className:"jsx-8751881a20a6730a"})]}),(0,s.jsxs)("label",{className:"jsx-8751881a20a6730a",children:["Output types (JSON)",(0,s.jsx)("textarea",{value:a.output_types,onChange:e=>K(a.node_id,"output_types",e.target.value),rows:2,className:"jsx-8751881a20a6730a"})]}),(0,s.jsxs)("label",{className:"jsx-8751881a20a6730a",children:["Parameters (JSON)",(0,s.jsx)("textarea",{value:a.parameters,onChange:e=>K(a.node_id,"parameters",e.target.value),rows:2,className:"jsx-8751881a20a6730a"})]})]},a.node_id))]})]}),(0,s.jsxs)("section",{className:"jsx-8751881a20a6730a surface-section",children:[(0,s.jsx)("h2",{className:"jsx-8751881a20a6730a",children:"Connections"}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a edge-grid",children:[(0,s.jsxs)("select",{value:I.from_node,onChange:a=>q({...I,from_node:a.target.value,from_output:""}),className:"jsx-8751881a20a6730a",children:[(0,s.jsx)("option",{value:"",className:"jsx-8751881a20a6730a",children:"From node"}),_.map(a=>(0,s.jsx)("option",{value:a.node_id,className:"jsx-8751881a20a6730a",children:a.node_id},a.node_id))]}),(0,s.jsxs)("select",{value:I.from_output,onChange:a=>q({...I,from_output:a.target.value}),className:"jsx-8751881a20a6730a",children:[(0,s.jsx)("option",{value:"",className:"jsx-8751881a20a6730a",children:"From output"}),((null===(a=F[I.from_node])||void 0===a?void 0:a.outputs)||[]).map(a=>(0,s.jsx)("option",{value:a,className:"jsx-8751881a20a6730a",children:a},a))]}),(0,s.jsxs)("select",{value:I.to_node,onChange:a=>q({...I,to_node:a.target.value,to_input:""}),className:"jsx-8751881a20a6730a",children:[(0,s.jsx)("option",{value:"",className:"jsx-8751881a20a6730a",children:"To node"}),_.map(a=>(0,s.jsx)("option",{value:a.node_id,className:"jsx-8751881a20a6730a",children:a.node_id},a.node_id))]}),(0,s.jsxs)("select",{value:I.to_input,onChange:a=>q({...I,to_input:a.target.value}),className:"jsx-8751881a20a6730a",children:[(0,s.jsx)("option",{value:"",className:"jsx-8751881a20a6730a",children:"To input"}),((null===(e=F[I.to_node])||void 0===e?void 0:e.inputs)||[]).map(a=>(0,s.jsx)("option",{value:a,className:"jsx-8751881a20a6730a",children:a},a))]})]}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a btn-row",children:[(0,s.jsx)("button",{onClick:function(){var a,e;if(O(""),!I.from_node||!I.to_node||!I.from_output||!I.to_input){O("Choose from/to node and ports first.");return}if(I.from_node===I.to_node){O("Self-loop is not allowed.");return}let t="".concat(I.from_node,".").concat(I.from_output,"->").concat(I.to_node,".").concat(I.to_input);if(v.some(a=>"".concat(a.from_node,".").concat(a.from_output,"->").concat(a.to_node,".").concat(a.to_input)===t)){O("Duplicate edge: ".concat(t));return}let s=null===(a=U.outputs[I.from_node])||void 0===a?void 0:a[I.from_output],o=null===(e=U.inputs[I.to_node])||void 0===e?void 0:e[I.to_input];if(!s||!o){O("Selected edge ports are invalid.");return}if(s!==o){O("Type mismatch: ".concat(s," cannot connect to ").concat(o,"."));return}y(a=>[...a,I]),q({from_node:"",from_output:"",to_node:"",to_input:""}),z("Edge added (".concat(s,")."))},className:"jsx-8751881a20a6730a",children:"Add Edge"}),(0,s.jsx)("button",{onClick:()=>{y(a=>a.slice(0,Math.max(0,a.length-1)))},disabled:0===v.length,className:"jsx-8751881a20a6730a",children:"Remove Last Edge"})]}),(0,s.jsx)("pre",{className:"jsx-8751881a20a6730a code-box",children:JSON.stringify(v,null,2)})]}),(0,s.jsxs)("section",{className:"jsx-8751881a20a6730a surface-section",children:[(0,s.jsx)("h2",{className:"jsx-8751881a20a6730a",children:"Run Monitor"}),(0,s.jsx)("div",{className:"jsx-8751881a20a6730a btn-row",children:(0,s.jsx)("button",{onClick:()=>void Z(),disabled:!(null==D?void 0:D.run_id),className:"jsx-8751881a20a6730a",children:"Refresh Last Run"})}),D?(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a",children:[(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a",children:["Run ID: ",D.run_id]}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a",children:["Completed: ",D.completed_runs,"/",D.submitted_runs]}),(0,s.jsxs)("div",{className:"jsx-8751881a20a6730a",children:["Duration: ",D.duration_ms," ms"]})]}):(0,s.jsx)("p",{className:"jsx-8751881a20a6730a",children:"No run yet."}),(0,s.jsx)("pre",{className:"jsx-8751881a20a6730a code-box",children:JSON.stringify(J||{},null,2)})]}),C?(0,s.jsx)("p",{className:"jsx-8751881a20a6730a err-text",children:C}):null,S?(0,s.jsx)("p",{className:"jsx-8751881a20a6730a ok-text",children:S}):null,(0,s.jsx)(n(),{id:"8751881a20a6730a",children:'.workflow-page.jsx-8751881a20a6730a{--bg:#edf2f4;--surface:#ffffff;--line:#ccd6dc;--ink:#10222c;--muted:#4d626e;--teal:#0f7d76;--orange:#c8611f;--deep:#1f3441;min-height:100vh;padding:24px max(12px,min(2vw,28px))40px;padding:24px clamp(12px,2vw,28px)40px;display:grid;grid-template-columns:repeat(12,minmax(0,1fr));gap:14px;background:-webkit-repeating-linear-gradient(left,rgba(255,255,255,.26),rgba(255,255,255,.26)1px,transparent 1px,transparent 26px),-webkit-repeating-linear-gradient(bottom,rgba(255,255,255,.26),rgba(255,255,255,.26)1px,transparent 1px,transparent 26px),var(--bg);background:-moz-repeating-linear-gradient(left,rgba(255,255,255,.26),rgba(255,255,255,.26)1px,transparent 1px,transparent 26px),-moz-repeating-linear-gradient(bottom,rgba(255,255,255,.26),rgba(255,255,255,.26)1px,transparent 1px,transparent 26px),var(--bg);background:-o-repeating-linear-gradient(left,rgba(255,255,255,.26),rgba(255,255,255,.26)1px,transparent 1px,transparent 26px),-o-repeating-linear-gradient(bottom,rgba(255,255,255,.26),rgba(255,255,255,.26)1px,transparent 1px,transparent 26px),var(--bg);background:repeating-linear-gradient(90deg,rgba(255,255,255,.26),rgba(255,255,255,.26)1px,transparent 1px,transparent 26px),repeating-linear-gradient(0deg,rgba(255,255,255,.26),rgba(255,255,255,.26)1px,transparent 1px,transparent 26px),var(--bg);color:var(--ink);font-family:"IBM Plex Sans","Noto Sans TC","Segoe UI",sans-serif;position:relative;overflow:hidden}.ambient-shape.jsx-8751881a20a6730a{position:fixed;width:280px;height:280px;-webkit-border-radius:999px;-moz-border-radius:999px;border-radius:999px;pointer-events:none;z-index:0;opacity:.18;-webkit-filter:blur(8px);filter:blur(8px)}.shape-a.jsx-8751881a20a6730a{top:-90px;left:-70px;background:#0f7d76}.shape-b.jsx-8751881a20a6730a{top:-65px;right:-90px;background:#c8611f}.hero-panel.jsx-8751881a20a6730a{z-index:1;grid-column:1/-1;border:1px solid var(--line);-webkit-border-radius:18px;-moz-border-radius:18px;border-radius:18px;padding:18px;background:var(--surface);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;gap:14px;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start}.hero-kicker.jsx-8751881a20a6730a{margin:0 0 4px;letter-spacing:.14em;text-transform:uppercase;font-size:11px;font-weight:700;color:var(--teal)}.hero-title.jsx-8751881a20a6730a{margin:0;font-family:"Space Grotesk","IBM Plex Sans",sans-serif;font-size:max(30px,min(4.6vw,48px));font-size:clamp(30px,4.6vw,48px);line-height:1.03;letter-spacing:.01em}.hero-note.jsx-8751881a20a6730a{margin:6px 0 0;max-width:720px;color:var(--muted);font-size:13px}.health-pill.jsx-8751881a20a6730a{border:1px solid var(--line);-webkit-border-radius:999px;-moz-border-radius:999px;border-radius:999px;padding:8px 14px;font-size:12px;font-weight:700;white-space:nowrap;background:#f7fafb}.health-pill-ok.jsx-8751881a20a6730a{border-color:#78b38f;color:#135a2e;background:#e9f8ee}.health-pill-warn.jsx-8751881a20a6730a{border-color:#d08f7a;color:#972315;background:#fff0ea}.surface-section.jsx-8751881a20a6730a{z-index:1;grid-column:1/-1;border:1px solid var(--line);-webkit-border-radius:16px;-moz-border-radius:16px;border-radius:16px;background:var(--surface);padding:14px;display:grid;gap:10px;-webkit-animation:rise 420ms ease both;-moz-animation:rise 420ms ease both;-o-animation:rise 420ms ease both;animation:rise 420ms ease both}.split-shell.jsx-8751881a20a6730a{grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}.mini-card.jsx-8751881a20a6730a{border:1px solid var(--line);-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:12px;display:grid;gap:8px;background:#fbfdfe}.tool-shell.jsx-8751881a20a6730a{grid-template-columns:300px minmax(0,1fr);gap:12px}.canvas-box.jsx-8751881a20a6730a{border:2px dashed#8c959f;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:12px;min-height:360px;background:#fff}.node-card.jsx-8751881a20a6730a{border:1px solid#d0d7de;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;padding:8px;margin-bottom:8px;background:#fbfdfe}.palette-item.jsx-8751881a20a6730a{border:1px solid#8c959f;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;padding:8px;margin-bottom:8px;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab;background:#f6f8fa;font-size:12px;color:var(--muted)}.palette-item.jsx-8751881a20a6730a strong.jsx-8751881a20a6730a{font-size:13px;color:var(--ink)}.node-top.jsx-8751881a20a6730a{display:grid;grid-template-columns:110px minmax(0,1fr)120px;gap:8px;margin-bottom:6px}h2.jsx-8751881a20a6730a{margin:0;font-family:"Space Grotesk","IBM Plex Sans",sans-serif;font-size:21px;letter-spacing:.01em}p.jsx-8751881a20a6730a,li.jsx-8751881a20a6730a{color:var(--muted)}label.jsx-8751881a20a6730a{display:grid;gap:6px;color:var(--muted);font-size:12px;font-weight:700;letter-spacing:.02em}input.jsx-8751881a20a6730a,select.jsx-8751881a20a6730a,textarea.jsx-8751881a20a6730a{min-height:42px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;border:1px solid#c8d2d8;background:#fff;color:var(--ink);padding:8px 10px;font-size:14px;font-family:"IBM Plex Sans","Noto Sans TC","Segoe UI",sans-serif}textarea.jsx-8751881a20a6730a{min-height:68px;resize:vertical}input.jsx-8751881a20a6730a:focus,select.jsx-8751881a20a6730a:focus,textarea.jsx-8751881a20a6730a:focus{outline:2px solid#0f7d76;outline-offset:1px;border-color:#0f7d76}.readonly.jsx-8751881a20a6730a{background:#f6f8fa}button.jsx-8751881a20a6730a{min-height:42px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;border:1px solid transparent;padding:8px 12px;cursor:pointer;font-size:13px;font-weight:700;letter-spacing:.03em;text-transform:uppercase;background:var(--teal);color:#fff;-webkit-transition:border-color 150ms ease,background-color 150ms ease,color 150ms ease;-moz-transition:border-color 150ms ease,background-color 150ms ease,color 150ms ease;-o-transition:border-color 150ms ease,background-color 150ms ease,color 150ms ease;transition:border-color 150ms ease,background-color 150ms ease,color 150ms ease}button.jsx-8751881a20a6730a:nth-of-type(even){background:var(--deep)}button.jsx-8751881a20a6730a:hover{border-color:#0c645f}button.jsx-8751881a20a6730a:disabled{opacity:.55;cursor:default}.btn-row.jsx-8751881a20a6730a{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:8px}.wide-select.jsx-8751881a20a6730a{min-width:280px;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}.edge-grid.jsx-8751881a20a6730a{display:grid;grid-template-columns:repeat(4,minmax(180px,1fr));gap:8px}.code-box.jsx-8751881a20a6730a{background:#f6f8fa;border:1px solid#d0d7de;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;padding:10px;margin:0;overflow-x:auto;color:#243746;font-size:12px}.ok-text.jsx-8751881a20a6730a{margin:0;color:#14532d;font-weight:700}.err-text.jsx-8751881a20a6730a{margin:0;color:#b42318;font-weight:700}*.jsx-8751881a20a6730a:hover{-webkit-box-shadow:none!important;-moz-box-shadow:none!important;box-shadow:none!important}.reveal.jsx-8751881a20a6730a{-webkit-animation:rise 380ms ease both;-moz-animation:rise 380ms ease both;-o-animation:rise 380ms ease both;animation:rise 380ms ease both}.reveal-1.jsx-8751881a20a6730a{-webkit-animation-delay:20ms;-moz-animation-delay:20ms;-o-animation-delay:20ms;animation-delay:20ms}@-webkit-keyframes rise{from{opacity:0;-webkit-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes rise{from{opacity:0;-moz-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes rise{from{opacity:0;-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes rise{from{opacity:0;-webkit-transform:translatey(8px);-moz-transform:translatey(8px);-o-transform:translatey(8px);transform:translatey(8px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}@media(max-width:980px){.hero-panel.jsx-8751881a20a6730a{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.split-shell.jsx-8751881a20a6730a,.tool-shell.jsx-8751881a20a6730a{grid-template-columns:1fr}.edge-grid.jsx-8751881a20a6730a{grid-template-columns:repeat(2,minmax(0,1fr))}.node-top.jsx-8751881a20a6730a{grid-template-columns:1fr}.wide-select.jsx-8751881a20a6730a{min-width:0;width:100%}}'})]}):(0,s.jsx)("main",{className:"workflow-page",children:(0,s.jsxs)("section",{className:"surface-section",children:[(0,s.jsx)("h2",{children:"Checking session..."}),(0,s.jsx)("p",{children:"Redirecting to login page."})]})})}},7907:function(a,e,t){"use strict";var s=t(5313);t.o(s,"useRouter")&&t.d(e,{useRouter:function(){return s.useRouter}})}},function(a){a.O(0,[102,971,69,744],function(){return a(a.s=3890)}),_N_E=a.O()}]);